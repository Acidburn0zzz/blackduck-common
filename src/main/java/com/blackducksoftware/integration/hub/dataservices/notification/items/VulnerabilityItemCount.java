package com.blackducksoftware.integration.hub.dataservices.notification.items;

import com.blackducksoftware.integration.hub.api.notification.NotificationItem;
import com.blackducksoftware.integration.hub.api.notification.VulnerabilityNotificationItem;

public class VulnerabilityItemCount extends NotificationItemCount {

	private int addedCount = 0;
	private int updatedCount = 0;
	private int deletedCount = 0;

	public int getAddedCount() {
		return addedCount;
	}

	public int getUpdatedCount() {
		return updatedCount;
	}

	public int getDeletedCount() {
		return deletedCount;
	}

	@Override
	public int increment(final NotificationItem item) {

		final VulnerabilityNotificationItem notification = (VulnerabilityNotificationItem) item;
		if (notification.getContent() != null) {
			addedCount += notification.getContent().getNewVulnerabilityCount();
			updatedCount += notification.getContent().getUpdatedVulnerabilityCount();
			deletedCount += notification.getContent().getDeletedVulnerabilityCount();
		}
		return super.increment(item);
	}

	@Override
	public void reset() {
		addedCount = 0;
		updatedCount = 0;
		deletedCount = 0;
		super.reset();
	}
}
